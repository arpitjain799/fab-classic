
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Django Integration &#8212; fab-classic  documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="File and Directory Management" href="files.html" />
    <link rel="prev" title="Console Output Utilities" href="console.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-fabric.contrib.django">
<span id="django-integration"></span><h1>Django Integration<a class="headerlink" href="#module-fabric.contrib.django" title="Permalink to this headline">¶</a></h1>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.2.</span></p>
</div>
<p>These functions streamline the process of initializing Django’s settings module
environment variable. Once this is done, your fabfile may import from your
Django project, or Django itself, without requiring the use of <code class="docutils literal notranslate"><span class="pre">manage.py</span></code>
plugins or having to set the environment variable yourself every time you use
your fabfile.</p>
<p>Currently, these functions only allow Fabric to interact with
local-to-your-fabfile Django installations. This is not as limiting as it
sounds; for example, you can use Fabric as a remote “build” tool as well as
using it locally. Imagine the following fabfile:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fabric.api</span> <span class="k">import</span> <span class="n">run</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">hosts</span><span class="p">,</span> <span class="n">cd</span>
<span class="kn">from</span> <span class="nn">fabric.contrib</span> <span class="k">import</span> <span class="n">django</span>

<span class="n">django</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="s1">&#39;myproject&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">myproject.myapp.models</span> <span class="k">import</span> <span class="n">MyModel</span>

<span class="k">def</span> <span class="nf">print_instances</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">MyModel</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>

<span class="nd">@hosts</span><span class="p">(</span><span class="s1">&#39;production-server&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">print_production_instances</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">cd</span><span class="p">(</span><span class="s1">&#39;/path/to/myproject&#39;</span><span class="p">):</span>
        <span class="n">run</span><span class="p">(</span><span class="s1">&#39;fab print_instances&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>With Fabric installed on both ends, you could execute
<code class="docutils literal notranslate"><span class="pre">print_production_instances</span></code> locally, which would trigger <code class="docutils literal notranslate"><span class="pre">print_instances</span></code>
on the production server – which would then be interacting with your
production Django database.</p>
<p>As another example, if your local and remote settings are similar, you can use
it to obtain e.g. your database settings, and then use those when executing a
remote (non-Fabric) command. This would allow you some degree of freedom even
if Fabric is only installed locally:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fabric.api</span> <span class="k">import</span> <span class="n">run</span>
<span class="kn">from</span> <span class="nn">fabric.contrib</span> <span class="k">import</span> <span class="n">django</span>

<span class="n">django</span><span class="o">.</span><span class="n">settings_module</span><span class="p">(</span><span class="s1">&#39;myproject.settings&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">django.conf</span> <span class="k">import</span> <span class="n">settings</span>

<span class="k">def</span> <span class="nf">dump_production_database</span><span class="p">():</span>
    <span class="n">run</span><span class="p">(</span><span class="s1">&#39;mysqldump -u </span><span class="si">%s</span><span class="s1"> -p=</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> &gt; /tmp/prod-db.sql&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">DATABASE_USER</span><span class="p">,</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">DATABASE_PASSWORD</span><span class="p">,</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">DATABASE_NAME</span>
    <span class="p">))</span>
</pre></div>
</div>
<p>The above snippet will work if run from a local, development environment, again
provided your local <code class="docutils literal notranslate"><span class="pre">settings.py</span></code> mirrors your remote one in terms of
database connection info.</p>
<dl class="function">
<dt id="fabric.contrib.django.project">
<code class="descclassname">fabric.contrib.django.</code><code class="descname">project</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#fabric.contrib.django.project" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets <code class="docutils literal notranslate"><span class="pre">DJANGO_SETTINGS_MODULE</span></code> to <code class="docutils literal notranslate"><span class="pre">'&lt;name&gt;.settings'</span></code>.</p>
<p>This function provides a handy shortcut for the common case where one is
using the Django default naming convention for their settings file and
location.</p>
<p>Uses <a class="reference internal" href="#fabric.contrib.django.settings_module" title="fabric.contrib.django.settings_module"><code class="xref py py-obj docutils literal notranslate"><span class="pre">settings_module</span></code></a> – see its documentation for details on why and how
to use this functionality.</p>
</dd></dl>

<dl class="function">
<dt id="fabric.contrib.django.settings_module">
<code class="descclassname">fabric.contrib.django.</code><code class="descname">settings_module</code><span class="sig-paren">(</span><em>module</em><span class="sig-paren">)</span><a class="headerlink" href="#fabric.contrib.django.settings_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Set <code class="docutils literal notranslate"><span class="pre">DJANGO_SETTINGS_MODULE</span></code> shell environment variable to <code class="docutils literal notranslate"><span class="pre">module</span></code>.</p>
<p>Due to how Django works, imports from Django or a Django project will fail
unless the shell environment variable <code class="docutils literal notranslate"><span class="pre">DJANGO_SETTINGS_MODULE</span></code> is
correctly set (see <a class="reference external" href="http://docs.djangoproject.com/en/dev/topics/settings/">the Django settings docs</a>.)</p>
<p>This function provides a shortcut for doing so; call it near the top of
your fabfile or Fabric-using code, after which point any Django imports
should work correctly.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function sets a <strong>shell</strong> environment variable (via
<code class="docutils literal notranslate"><span class="pre">os.environ</span></code>) and is unrelated to Fabric’s own internal “env”
variables.</p>
</div>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">fab-classic</h1>
    
  </a>
</p>



<p class="blurb">Pythonic remote execution</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=ploxiln&repo=fab-classic&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/ploxiln/fab-classic">
    <img
        alt="https://secure.travis-ci.org/ploxiln/fab-classic.svg?branch=master"
        src="https://secure.travis-ci.org/ploxiln/fab-classic.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installing.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Overview and Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage/env.html">The environment dictionary, <code class="docutils literal notranslate"><span class="pre">env</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/execution.html">Execution model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/fab.html"><code class="docutils literal notranslate"><span class="pre">fab</span></code> options and arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/fabfiles.html">Fabfile construction and use</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/interactivity.html">Interaction with remote programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/library.html">Library Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/output_controls.html">Managing output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/parallel.html">Parallel execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/ssh.html">SSH behavior</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/tasks.html">Defining tasks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions (FAQ)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core/colors.html">Color output functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/context_managers.html">Context Managers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/decorators.html">Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/docs.html">Documentation helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/network.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/operations.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/utils.html">Utils</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="console.html">Console Output Utilities</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Django Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="files.html">File and Directory Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="project.html">Project Tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../running_tests.html">Running Fabric’s Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../old_changelog.html">Old Changelog</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;Fabric authors.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.9</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/api/contrib/django.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
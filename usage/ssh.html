
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>SSH behavior &#8212; fab-classic  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Defining tasks" href="tasks.html" />
    <link rel="prev" title="Parallel execution" href="parallel.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="ssh-behavior">
<h1>SSH behavior<a class="headerlink" href="#ssh-behavior" title="Permalink to this headline">¶</a></h1>
<p>Fabric currently makes use of a pure-Python SSH re-implementation for managing
connections, meaning that there are occasionally spots where it is limited by
that library’s capabilities. Below are areas of note where Fabric will exhibit
behavior that isn’t consistent with, or as flexible as, the behavior of the
<code class="docutils literal notranslate"><span class="pre">ssh</span></code> command-line program.</p>
<div class="section" id="unknown-hosts">
<h2>Unknown hosts<a class="headerlink" href="#unknown-hosts" title="Permalink to this headline">¶</a></h2>
<p>SSH’s host key tracking mechanism keeps tabs on all the hosts you attempt to
connect to, and maintains a <code class="docutils literal notranslate"><span class="pre">~/.ssh/known_hosts</span></code> file with mappings between
identifiers (IP address, sometimes with a hostname as well) and SSH keys. (For
details on how this works, please see the <a class="reference external" href="http://openssh.org/manual.html">OpenSSH documentation</a>.)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">paramiko</span></code> library is capable of loading up your <code class="docutils literal notranslate"><span class="pre">known_hosts</span></code> file,
and will then compare any host it connects to, with that mapping. Settings are
available to determine what happens when an unknown host (a host whose username
or IP is not found in <code class="docutils literal notranslate"><span class="pre">known_hosts</span></code>) is seen:</p>
<ul class="simple">
<li><strong>Reject</strong>: the host key is rejected and the connection is not made. This
results in a Python exception, which will terminate your Fabric session with a
message that the host is unknown.</li>
<li><strong>Add</strong>: the new host key is added to the in-memory list of known hosts, the
connection is made, and things continue normally. Note that this does <strong>not</strong>
modify your on-disk <code class="docutils literal notranslate"><span class="pre">known_hosts</span></code> file!</li>
<li><strong>Ask</strong>: not yet implemented at the Fabric level, this is a <code class="docutils literal notranslate"><span class="pre">paramiko</span></code>
library option which would result in the user being prompted about the
unknown key and whether to accept it.</li>
</ul>
<p>Whether to reject or add hosts, as above, is controlled in Fabric via the
<a class="reference internal" href="env.html#reject-unknown-hosts"><span class="std std-ref">env.reject_unknown_hosts</span></a> option, which is False
by default for convenience’s sake. We feel this is a valid tradeoff between
convenience and security; anyone who feels otherwise can easily modify their
fabfiles at module level to set <code class="docutils literal notranslate"><span class="pre">env.reject_unknown_hosts</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
</div>
<div class="section" id="known-hosts-with-changed-keys">
<h2>Known hosts with changed keys<a class="headerlink" href="#known-hosts-with-changed-keys" title="Permalink to this headline">¶</a></h2>
<p>The point of SSH’s key/fingerprint tracking is so that man-in-the-middle
attacks can be detected: if an attacker redirects your SSH traffic to a
computer under his control, and pretends to be your original destination
server, the host keys will not match. Thus, the default behavior of SSH (and
its Python implementation) is to immediately abort the connection when a host
previously recorded in <code class="docutils literal notranslate"><span class="pre">known_hosts</span></code> suddenly starts sending us a different
host key.</p>
<p>In some edge cases such as some EC2 deployments, you may want to ignore this
potential problem. Our SSH layer, at the time of writing, doesn’t give us
control over this exact behavior, but we can sidestep it by simply skipping the
loading of <code class="docutils literal notranslate"><span class="pre">known_hosts</span></code> – if the host list being compared to is empty, then
there’s no problem. Set <a class="reference internal" href="env.html#disable-known-hosts"><span class="std std-ref">env.disable_known_hosts</span></a> to
True when you want this behavior; it is False by default, in order to preserve
default SSH behavior.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Enabling <a class="reference internal" href="env.html#disable-known-hosts"><span class="std std-ref">env.disable_known_hosts</span></a> will leave
you wide open to man-in-the-middle attacks! Please use with caution.</p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">fab-classic</h1>
    
  </a>
</p>



<p class="blurb">Pythonic remote execution</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=ploxiln&repo=fab-classic&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Overview and Tutorial</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="env.html">The environment dictionary, <code class="docutils literal notranslate"><span class="pre">env</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="execution.html">Execution model</a></li>
<li class="toctree-l1"><a class="reference internal" href="fab.html"><code class="docutils literal notranslate"><span class="pre">fab</span></code> options and arguments</a></li>
<li class="toctree-l1"><a class="reference internal" href="fabfiles.html">Fabfile construction and use</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactivity.html">Interaction with remote programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="library.html">Library Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="output_controls.html">Managing output</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallel.html">Parallel execution</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SSH behavior</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#unknown-hosts">Unknown hosts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#known-hosts-with-changed-keys">Known hosts with changed keys</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Defining tasks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions (FAQ)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/core/colors.html">Color output functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/context_managers.html">Context Managers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/decorators.html">Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/docs.html">Documentation helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/network.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/operations.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/utils.html">Utils</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/contrib/console.html">Console Output Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/contrib/django.html">Django Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/contrib/files.html">File and Directory Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/contrib/project.html">Project Tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../running_tests.html">Running Fabric’s Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../old_changelog.html">Old Changelog</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;Fabric authors.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/usage/ssh.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
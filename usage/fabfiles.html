
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Fabfile construction and use &#8212; fab-classic  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Interaction with remote programs" href="interactivity.html" />
    <link rel="prev" title="fab options and arguments" href="fab.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="fabfile-construction-and-use">
<h1>Fabfile construction and use<a class="headerlink" href="#fabfile-construction-and-use" title="Permalink to this headline">¶</a></h1>
<p>This document contains miscellaneous sections about fabfiles, both how to best
write them, and how to use them once written.</p>
<div class="section" id="fabfile-discovery">
<span id="id1"></span><h2>Fabfile discovery<a class="headerlink" href="#fabfile-discovery" title="Permalink to this headline">¶</a></h2>
<p>Fabric is capable of loading Python modules (e.g. <code class="docutils literal notranslate"><span class="pre">fabfile.py</span></code>) or packages
(e.g. a <code class="docutils literal notranslate"><span class="pre">fabfile/</span></code> directory containing an <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>). By default, it
looks for something named (to Python’s import machinery) <code class="docutils literal notranslate"><span class="pre">fabfile</span></code> - so
either <code class="docutils literal notranslate"><span class="pre">fabfile/</span></code> or <code class="docutils literal notranslate"><span class="pre">fabfile.py</span></code>.</p>
<p>The fabfile discovery algorithm searches in the invoking user’s current working
directory or any parent directories. Thus, it is oriented around “project” use,
where one keeps e.g. a <code class="docutils literal notranslate"><span class="pre">fabfile.py</span></code> at the root of a source code tree. Such a
fabfile will then be discovered no matter where in the tree the user invokes
<code class="docutils literal notranslate"><span class="pre">fab</span></code>.</p>
<p>The specific name to be searched for may be overridden on the command-line with
the <a class="reference internal" href="fab.html#cmdoption-f"><code class="xref std std-option docutils literal notranslate"><span class="pre">-f</span></code></a> option, or by adding a <a class="reference internal" href="fab.html#fabricrc"><span class="std std-ref">fabricrc</span></a> line which
sets the value of <code class="docutils literal notranslate"><span class="pre">fabfile</span></code>. For example, if you wanted to name your fabfile
<code class="docutils literal notranslate"><span class="pre">fab_tasks.py</span></code>, you could create such a file and then call <code class="docutils literal notranslate"><span class="pre">fab</span> <span class="pre">-f</span>
<span class="pre">fab_tasks.py</span> <span class="pre">&lt;task</span> <span class="pre">name&gt;</span></code>, or add <code class="docutils literal notranslate"><span class="pre">fabfile</span> <span class="pre">=</span> <span class="pre">fab_tasks.py</span></code> to
<code class="docutils literal notranslate"><span class="pre">~/.fabricrc</span></code>.</p>
<p>If the given fabfile name contains path elements other than a filename (e.g.
<code class="docutils literal notranslate"><span class="pre">../fabfile.py</span></code> or <code class="docutils literal notranslate"><span class="pre">/dir1/dir2/custom_fabfile</span></code>) it will be treated as a
file path and directly checked for existence without any sort of searching.
When in this mode, tilde-expansion will be applied, so one may refer to e.g.
<code class="docutils literal notranslate"><span class="pre">~/personal_fabfile.py</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Fabric does a normal <code class="docutils literal notranslate"><span class="pre">import</span></code> (actually <code class="docutils literal notranslate"><span class="pre">importlib.import_module()</span></code>) of your
fabfile in order to access its contents – it does not do any <code class="docutils literal notranslate"><span class="pre">eval</span></code>-ing
or similar. In order for this to work, Fabric temporarily adds the found
fabfile’s containing folder to the Python load path (and removes it
immediately afterwards.)</p>
</div>
</div>
<div class="section" id="importing-fabric">
<span id="importing-the-api"></span><h2>Importing Fabric<a class="headerlink" href="#importing-fabric" title="Permalink to this headline">¶</a></h2>
<p>Because Fabric is just Python, you <em>can</em> import its components any way you
want. However, for the purposes of encapsulation and convenience (and to make
life easier for Fabric’s packaging script) Fabric’s public API is maintained in
the <code class="docutils literal notranslate"><span class="pre">fabric.api</span></code> module.</p>
<p>All of Fabric’s <a class="reference internal" href="../api/core/operations.html"><span class="doc">Operations</span></a>,
<a class="reference internal" href="../api/core/context_managers.html"><span class="doc">Context Managers</span></a>, <a class="reference internal" href="../api/core/decorators.html"><span class="doc">Decorators</span></a> and
<a class="reference internal" href="../api/core/utils.html"><span class="doc">Utils</span></a> are included in this module as a single, flat
namespace. This enables a very simple and consistent interface to Fabric within
your fabfiles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fabric.api</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># call run(), sudo(), etc etc</span>
</pre></div>
</div>
<p>This is not technically best practices (for <a class="reference external" href="http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html#importing">a
number of reasons</a>) and if you’re only using a couple of
Fab API calls, it <em>is</em> probably a good idea to explicitly <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">fabric.api</span>
<span class="pre">import</span> <span class="pre">env,</span> <span class="pre">run</span></code> or similar. However, in most nontrivial fabfiles, you’ll be
using all or most of the API, and the star import:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fabric.api</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>will be a lot easier to write and read than:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fabric.api</span> <span class="kn">import</span> <span class="n">abort</span><span class="p">,</span> <span class="n">cd</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">get</span><span class="p">,</span> <span class="n">hide</span><span class="p">,</span> <span class="n">hosts</span><span class="p">,</span> <span class="n">local</span><span class="p">,</span> <span class="n">prompt</span><span class="p">,</span> \
    <span class="n">put</span><span class="p">,</span> <span class="n">require</span><span class="p">,</span> <span class="n">roles</span><span class="p">,</span> <span class="n">run</span><span class="p">,</span> <span class="n">runs_once</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="n">show</span><span class="p">,</span> <span class="n">sudo</span><span class="p">,</span> <span class="n">warn</span>
</pre></div>
</div>
<p>so in this case we feel pragmatism overrides best practices.</p>
</div>
<div class="section" id="defining-tasks-and-importing-callables">
<h2>Defining tasks and importing callables<a class="headerlink" href="#defining-tasks-and-importing-callables" title="Permalink to this headline">¶</a></h2>
<p>For important information on what exactly Fabric will consider as a task when
it loads your fabfile, as well as notes on how best to import other code,
please see <a class="reference internal" href="tasks.html"><span class="doc">Defining tasks</span></a> in the <a class="reference internal" href="execution.html"><span class="doc">Execution model</span></a> documentation.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">fab-classic</h1>
    
  </a>
</p>



<p class="blurb">Pythonic remote execution</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=ploxiln&repo=fab-classic&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Overview and Tutorial</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="env.html">The environment dictionary, <code class="docutils literal notranslate"><span class="pre">env</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="execution.html">Execution model</a></li>
<li class="toctree-l1"><a class="reference internal" href="fab.html"><code class="docutils literal notranslate"><span class="pre">fab</span></code> options and arguments</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Fabfile construction and use</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fabfile-discovery">Fabfile discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="#importing-fabric">Importing Fabric</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defining-tasks-and-importing-callables">Defining tasks and importing callables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="interactivity.html">Interaction with remote programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="library.html">Library Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="output_controls.html">Managing output</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallel.html">Parallel execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="ssh.html">SSH behavior</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Defining tasks</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions (FAQ)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/core/colors.html">Color output functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/context_managers.html">Context Managers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/decorators.html">Decorators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/docs.html">Documentation helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/network.html">Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/operations.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core/utils.html">Utils</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/contrib/console.html">Console Output Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/contrib/django.html">Django Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/contrib/files.html">File and Directory Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/contrib/project.html">Project Tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../running_tests.html">Running Fabric’s Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../old_changelog.html">Old Changelog</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;Fabric authors.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/usage/fabfiles.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>